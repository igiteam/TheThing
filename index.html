<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>The Thing</title>

  <meta name="description"
    content="A The Thing port designed for running in vanilla JavaScript pre-ECMAScript 2015 (no WebAssembly) ">
  <meta name="keywords" content="The Thing">
  <link rel="icon" href="https://cdn.sdappnet.cloud/rtx/images/betateam.png" type="image/png">
  <link rel="apple-touch-icon" href="https://cdn.sdappnet.cloud/rtx/images/betateam.png" sizes="180x180">
  <link rel="icon" type="image/png" href="https://cdn.sdappnet.cloud/rtx/images/betateam.png" sizes="192x192">
  <link rel="icon" type="image/png" href="https://cdn.sdappnet.cloud/rtx/images/betateam.png" sizes="512x512">
  <meta itemprop="name" content="The Thing">
  <meta itemprop="description"
    content="A The Thing port designed for running in vanilla JavaScript pre-ECMAScript 2015 (no WebAssembly) ">
  <meta property="og:title" content="The Thing">
  <meta property="og:description"
    content="A The Thing port designed for running in vanilla JavaScript pre-ECMAScript 2015 (no WebAssembly) ">
  <meta property="og:url" content="">
  <meta property="og:type" content="website">
  <meta name="twitter:title" content="The Thing">
  <meta name="twitter:description"
    content="A The Thing port designed for running in vanilla JavaScript pre-ECMAScript 2015 (no WebAssembly) ">
  <meta name="twitter:card" content="summary_large_image">
  <link rel="apple-touch-icon" href="https://cdn.sdappnet.cloud/rtx/images/betateam.png" sizes="180x180">

  <link rel="apple-touch-icon" href="https://cdn.sdappnet.cloud/rtx/images/betateam.png" sizes="180x180">

  <style>
    html,
    body {
      padding: 0;
      margin: 0;
      max-width: 100vw;
      max-height: 100vh;
      overflow: hidden;
      overscroll-behavior: none;
      background-color: #000;
      touch-action: none;
      user-select: none;
      -moz-user-select: none;
      -webkit-user-select: none;
      -webkit-tap-highlight-color: transparent
    }

    .logo {
      position: fixed;
      left: 0px;
      top: -30px;
      width: 100%;
      height: 100%;
      background-size: 75% auto;
      background-position: center center;
      background-repeat: no-repeat;
      background-image: url("https://cdn.sdappnet.cloud/rtx/images/TheThing.png")
    }

    .blizzard {
      position: fixed;
      left: 0px;
      top: 0px;
      width: 100%;
      height: 100%;
      background-size: 100% auto;
      background-position: center center;
      background-repeat: no-repeat;
      background-image: url("https://raw.githubusercontent.com/ProjectIGIRemakeTeam/TheThing/refs/heads/master/blizzard.gif");
      opacity: 0.08;
    }

    #container {
      display: none
    }

    input[type=file] {
      display: none
    }

    #email {
      position: fixed;
      right: 0;
      bottom: 0;
      padding-right: 15px;
      line-height: 3.2;
      font-family: Arial;
      font-size: 16px;
      color: #fff;
      user-select: none;
      -webkit-user-select: none
    }

    #email a {
      text-decoration: none;
      color: #fff;
      background-color: transparent;
      border: 0;
      outline: 0
    }

    #email a:focus {
      text-decoration: none;
      outline: 1px solid #fff
    }

    #demo-loader {
      display: none;
      position: fixed;
      left: 0;
      bottom: 10px;
      right: 0;
      width: 64px;
      height: 64px;
      margin: 0 auto;
      filter: drop-shadow(2px 2px 2px #000);
      cursor: pointer;
      background-color: transparent;
      border: 0;
      outline: 0
    }

    #demo-loader:focus {
      outline: 1px solid #fff
    }

    #demo-loader:hover {
      filter: brightness(110%)
    }

    #file-selector {
      display: none;
      position: fixed;
      left: 0;
      bottom: 10px;
      right: 0;
      width: 64px;
      height: 64px;
      margin: 0 auto;
      filter: drop-shadow(2px 2px 2px #000);
      cursor: pointer;
      background-color: transparent;
      border: 0;
      outline: 0
    }

    #file-selector:focus {
      outline: 1px solid #fff
    }

    #file-selector:hover {
      filter: brightness(110%)
    }

    #game {
      width: 100vw;
      height: 100vh
    }

    .pleasewait {
      position: fixed;
      width: 64px;
      height: 64px;
      left: 0;
      right: 0;
      top: 0;
      bottom: 0;
      margin: auto auto;
      border: 0
    }

    .lds-spinner {
      color: #fff;
      display: inline-block;
      position: relative;
      width: 64px;
      height: 64px
    }

    .lds-spinner div {
      transform-origin: 32px 32px;
      animation: lds-spinner 1.2s linear infinite
    }

    .lds-spinner div:after {
      content: " ";
      display: block;
      position: absolute;
      top: 3px;
      left: 29px;
      width: 5px;
      height: 14px;
      border-radius: 20%;
      background: #fff
    }

    .lds-spinner div:nth-child(1) {
      transform: rotate(0deg);
      animation-delay: -1.1s
    }

    .lds-spinner div:nth-child(2) {
      transform: rotate(30deg);
      animation-delay: -1s
    }

    .lds-spinner div:nth-child(3) {
      transform: rotate(60deg);
      animation-delay: -.9s
    }

    .lds-spinner div:nth-child(4) {
      transform: rotate(90deg);
      animation-delay: -.8s
    }

    .lds-spinner div:nth-child(5) {
      transform: rotate(120deg);
      animation-delay: -.7s
    }

    .lds-spinner div:nth-child(6) {
      transform: rotate(150deg);
      animation-delay: -.6s
    }

    .lds-spinner div:nth-child(7) {
      transform: rotate(180deg);
      animation-delay: -.5s
    }

    .lds-spinner div:nth-child(8) {
      transform: rotate(210deg);
      animation-delay: -.4s
    }

    .lds-spinner div:nth-child(9) {
      transform: rotate(240deg);
      animation-delay: -.3s
    }

    .lds-spinner div:nth-child(10) {
      transform: rotate(270deg);
      animation-delay: -.2s
    }

    .lds-spinner div:nth-child(11) {
      transform: rotate(300deg);
      animation-delay: -.1s
    }

    .lds-spinner div:nth-child(12) {
      transform: rotate(330deg);
      animation-delay: 0s
    }

    @keyframes lds-spinner {
      0% {
        opacity: 1
      }

      to {
        opacity: 0
      }
    }
  </style>
</head>

<body>
  <div id="game"></div>
  <div class="pleasewait">
    <div class="lds-spinner">
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
    </div>
  </div>
  <div id="container">
    <div class="logo"></div>
    <div class="blizzard"></div>
    <button id="demo-loader">
      <svg width="100%" height="100%" viewBox="0 0 502 502">
        <circle fill="#FFF" cx="250" cy="250" r="200" />
        <path fill="#b9180b"
          d="M251,1C112.929,1,1,112.929,1,251s111.929,250,250,250s250-111.929,250-250S389.071,1,251,1z M164.75,366  V136l230,115L164.75,366z" />
      </svg>
    </button>
    <button id="file-selector">
      <svg width="100%" height="100%" viewBox="0 0 502 502">
        <circle fill="#FFF" cx="250" cy="250" r="200" />
        <path fill="#b9180b"
          d="M251,1C112.929,1,1,112.929,1,251s111.929,250,250,250s250-111.929,250-250S389.071,1,251,1z   M251.283,111.853L351,236.738h-56.935v73.761H208.51v-73.761h-56.941L251.283,111.853z M208.51,336.122v-19.418h85.556v19.418  H208.51z M294.065,341.665v10.186H208.51v-10.186H294.065z M391,380.147c0,5.522-4.477,10-10,10H121c-5.523,0-10-4.478-10-10  v-72.935c0-5.743,4.643-10.399,10.37-10.399s10.37,4.656,10.37,10.399v62.194h238.52v-62.194c0-5.743,4.643-10.399,10.37-10.399  S391,301.47,391,307.213V380.147z" />
      </svg>
    </button>
    <input type="file" id="file-input" multiple>
  </div>
  <script src="Quake3.min.js"></script>
  <script>
    var container = document.getElementById("container")
    var gameWrapper = document.getElementById("game")
    var demoLoader = document.getElementById("demo-loader")
    var fileSelector = document.getElementById("file-selector")
    var fileInput = document.getElementById("file-input")
    var pleaseWait = document.querySelector(".pleasewait")

    window.addEventListener("load", function () {
      if (window.top == window.self) {
        pleaseWait.style.display = "none"
        container.style.display = "block"

        var currentURL = new URL(window.location.href).searchParams
        var demoRequired = currentURL.has("demo")

        if (demoRequired) {
          demoLoader.style.display = "block"
          demoLoader.tabIndex = 1
        } else {
          fileSelector.style.display = "block"
          fileSelector.tabIndex = 1
        }

        gameWrapper.addEventListener("contextmenu", function (event) {
          event.preventDefault()
        })

        fileSelector.addEventListener("click", function () {
          fileInput.click()
        })

        demoLoader.addEventListener("click", function (event) {
          container.style.display = "none"
          pleaseWait.style.display = "block"

          // no fetch here because the entire project
          // is compatible with pre 2015 environments.
          var xhr = new XMLHttpRequest()
          xhr.open("GET", "DEMO.pk3", true)
          xhr.responseType = "arraybuffer"
          xhr.onreadystatechange = function () {
            if (xhr.readyState === 4 && xhr.status === 200) {
              var blob = new Blob([xhr.response], {
                type: "application/octet-stream",
              })
              blob.name = "pak0.pk3"

              embedQuake3({
                container: "game",
                files: [blob],
                cbStarted: function cbStarted() {
                  pleaseWait.style.display = "none"
                },
              })
            }
          }

          xhr.send(null)
        })

        fileInput.addEventListener("change", function (event) {
          var files = event.target.files
          var hasPk3 = false

          for (var i = 0; i < files.length; i++) {
            if (
              files[i].name.toLowerCase().indexOf(".pk3") ===
              files[i].name.length - 4
            ) {
              hasPk3 = true
              break
            }
          }

          if (!hasPk3) {
            location.reload()
            return
          }

          container.style.display = "none"
          pleaseWait.style.display = "block"

          embedQuake3({
            container: "game",
            files: event.target.files,
            cbStarted: function cbStarted() {
              pleaseWait.style.display = "none"
            },
          })
        })

        window.addEventListener("keydown", function (event) {
          var KEY_CTRL = event.ctrlKey || event.metaKey
          var KEY_P = event.code === "KeyP"
          var KEY_F = event.code === "KeyF"

          if (KEY_CTRL && KEY_P) {
            event.preventDefault()
            downloadProfileFileQuake3()
          }

          if (KEY_CTRL && KEY_F) {
            event.preventDefault()
            requestFullscreenQuake3()
          }
        })
      }
    })
  </script>
</body>

</html>